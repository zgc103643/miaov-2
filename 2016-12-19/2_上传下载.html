<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Document</title>
<style>
#loading{
	width:0;
	height: 30px;
	background: #77A444;
	border-radius:5px;
	transition:2s;
}
</style>
</head>
<body>
	<img src="" id="img">
	<!--<form action="post_file.php" method="post" enctype="multipart/form-data">-->
		<!--<input type="file" name="file" id="file" value="" />-->
		<!--<input type="submit" value="上传"/>-->
		<input type="file" id="file" value="" />
		<input type="button" value="上传" id="btn"/>
		<div id="loading"></div>
	<!--</form>-->
<script type="text/javascript">
	/*
		ajax的缺点：
			没有返回键
			
		在上传的时候，通过上传元素下有个属性files，这个属性就是要上传的数据
		val = file.files[0];
		
		readAsBinaryString
		
		ajax.upload.onprogress
			监控上传进度
				ev.loaded  每次上传的大小
				ev.total   总大小
	*/
	
	var btn = document.getElementById('btn');
	var files = document.getElementById('file');
	var img = document.getElementById('img');
	var loading = document.getElementById('loading');
	btn.addEventListener('click',click);
	function click(){
		var val = files.files[0];
		var ajax = new XMLHttpRequest();
		ajax.open('post','post_file.php');
		var f = new FormData();
		
		ajax.upload.onprogress = function(ev){
			loading.style.width = (ev.loaded / ev.total)*400 + 'px';
			console.log(ev);
		}
		
		f.append('file',val);
		ajax.send(f);
	}
	
	
	
	
</script>
</body>
</html>